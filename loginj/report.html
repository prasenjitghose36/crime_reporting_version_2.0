<html>
   <head>
        <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
   <link rel="stylesheet" type="text/css" href="bootstrap/css/bootstrap.min.css">
        </head>
    <style>
        @media screen and (max-width:720px)
        {
        body{
            background-image: url(grayscale-photography-of-woman-inside-jail-2307045.jpg);
            background-size: cover;
            background-repeat: no-repeat;      
        }
            }
        
        @media screen and (min-width:721px)
        {
        body{
            background-image: url(crime-scene-do-not-cross-signage-923681.jpg);
            background-size: cover;
            background-repeat: no-repeat;      
        }
            }
        hr{
            background: white;
        }
        .contact-form{
            background:rgba(0,0,0,.6);
            color: white;
            margin-top: 100px;
            padding: 20px;
            box-shadow: 0px 0px 10px 3px grey;
        }
    
    
    </style>
    <body>
    <div class="container contact-form">
        <h1>CRIME REPORT</h1>
        <hr>
        <div class="row">
            <div class="col-md-6">
            <p>Most people associate policing with fighting crime. Stories about policing and crime have always been popular in the news media as well as with novelists, playwrights and film makers. But these crime stories tend to be sensational. They focus on violent offences - stabbing, shooting, murder, rape - and on the behaviour of gangs. In fact most criminal offending is (and always was) petty and usually involved the theft of small items or minor acts of vandalism.

Up until the end of the eighteenth century crime was associated with acts of personal depravity. Explosive economic and demographic growth and resultant urban changes in early nineteenth-century Britain led contemporaries to view 'change' as a social force in its own terms. Linked with notions of 'change' were fears about the collapse of 'traditional values' such as the break-up of extended families as society moved from a rural to urban base, and the sinister spectre of the 'poor'. The criminal, especially the offender drawn from the poorest section of the working class, symbolized these changes. Alongside these social dislocations was the advent of the collection of various forms of economic and social statistics. Criminal statistics began to be collected for England and Wales from 1810, but the first figures collected went back to 1805.</p>
            </div>
            <div class="col-md-6">
                 <div class="form-group">
                <label>Img or video </label>
                <input type="file"  id="image" class="form-control">
                </div>
               
                 <div class="form-group">
                <label>Date</label>
                <input type="date"  id="cdate" class="form-control">
                </div>
                <div class="form-group">
                <label>Place</label>
                <input type="text" id="cplace" class="form-control">
                </div>
                <div class="form-group">
                <label>Crime Report Type</label>
                <textarea class="form-control" rows="5" id="cmsg"></textarea>
                </div>
                <div class="form-group">
            <button class="btn btn-primary btn-block" id="getl">REPORT</button>
                    <p id="fjj" style="display: none;">WAIT FOR A WHILE WE RECORD YOUR RESPONSE</p>
                </div>
                
            
            </div>
        
        </div>
        
        
        
        
        
        </div>
        <script>
            var url;
            var emkey= sessionStorage.getItem("emkey");
    if(emkey==null)
        {
            window.open('ki.html','_self');
        }
            document.getElementById("getl").addEventListener("click",getreport);
            function getreport()
             {
                 var fg= document.getElementById("getl");
    if(fg.style.display==="none"){
        fg.style.display="block";
        
        
    }else{
        fg.style.display="none";
    }
                 var Yg= document.getElementById("fjj");
    if(Yg.style.display==="none"){
        Yg.style.display="block";
        
        
    }else{
        Yg.style.display="none";
    }
                 
                 
                 if (navigator.geolocation) {
    navigator.geolocation.getCurrentPosition(showPosition, showError);
  } else { 
    x.innerHTML = "Geolocation is not supported by this browser.";
  }

    

function showPosition(position) {
     var cordiref= firebase.database().ref("crimecredential/");
        cordiref.orderByChild("email").equalTo(emkey).on("child_added", function(data){
          var newVok= data.val();
            var ty=newVok.name;

            
            
    
                 var today = new Date();
            var fg= today.getFullYear()+'-'+(today.getMonth()+1)+'-'+today.getDate();
            var tyu= today.getHours()+":"+today.getMinutes()+":"+today.getSeconds();
              var image= document.getElementById("image").files[0];
                               var imagename= image.name+fg+tyu;
            var storageRef=firebase.storage().ref('images/'+imagename);
            var uploadTask=storageRef.put(image);
            uploadTask.on('state_changed',function(snapshot){
             var progress=(snapshot.bytesTransferred/snapshot.totalBytes)*100;
                console.log( "uplod is"+ progress +"done");
                if(progress==100)
                    {
                        window.alert("complain submitted sucessfully");
                         window.open('choice.html','_self');
                        
                    }
            },function(error){
                console.log(error.message);
            },function(){
                uploadTask.snapshot.ref.getDownloadURL().then(function(downloadURL){
                    
                    sessionStorage.setItem("urlg",downloadURL);
                    
                });
                
            });
                         
                         
                var kpliref = firebase.database().ref('complaints/');
            var urlg=sessionStorage.getItem("urlg")
    var data={
        
        urlhrefa:urlg,                                         
        email: emkey,
        name: ty,
        place: document.getElementById("cplace").value,
         date: document.getElementById("cdate").value,
        message: document.getElementById("cmsg").value,
        datereported:fg,
        timereported:tyu,
        latitude:position.coords.latitude,
        longitude:position.coords.longitude
        
    }
     kpliref.push(data)
 });   
    
}
                  function showError(error) {
                      
            
            
            
    
                 
  switch(error.code) {
    case error.PERMISSION_DENIED:
      x.innerHTML = "User denied the request for Geolocation."
      break;
    case error.POSITION_UNAVAILABLE:
      x.innerHTML = "Location information is unavailable."
      break;
    case error.TIMEOUT:
      x.innerHTML = "The request to get user location timed out."
      break;
    case error.UNKNOWN_ERROR:
      x.innerHTML = "An unknown error occurred."
      break;
  }
}
             }
    
            
            
        
        
        
        </script>
        
    
    
    <script src="https://www.gstatic.com/firebasejs/7.13.2/firebase-app.js"></script>

<!-- TODO: Add SDKs for Firebase products that you want to use
     https://firebase.google.com/docs/web/setup#available-libraries -->
<script src="https://www.gstatic.com/firebasejs/7.13.2/firebase-analytics.js"></script>
    <script src="https://www.gstatic.com/firebasejs/7.13.2/firebase-auth.js"></script>
  <script src="https://www.gstatic.com/firebasejs/7.13.2/firebase-firestore.js"></script>
    <script src="https://www.gstatic.com/firebasejs/7.13.2/firebase-database.js"></script>
            <script src="https://www.gstatic.com/firebasejs/7.13.2/firebase-storage.js"></script>
        <script>
  // Your web app's Firebase configuration
    var config = {
    
   apiKey: "AIzaSyDN16XLfkDqVgt5h0tpXdMgfEJ5zc1iM9c",
    authDomain: "crime-reporting-app-4442a.firebaseapp.com",
    databaseURL: "https://crime-reporting-app-4442a.firebaseio.com",
    projectId: "crime-reporting-app-4442a",
    storageBucket: "crime-reporting-app-4442a.appspot.com",
    messagingSenderId: "524586625644",
    appId: "1:524586625644:web:03a76475ef62c4d4b5c649",
    measurementId: "G-FGCGMFQV2X"
  };
     firebase.initializeApp(config);
    console.log(firebase);
  
    
    
      // Set the configuration for your app
  // TODO: Replace with your project's config object
  
 

  // Get a reference to the database service
  
        
</script>
    </body>



</html>